<!DOCTYPE html>
<html>
<head>
    <title>Depression Detection Tool</title>
    <link rel="stylesheet" href="{{ url_for('serve_styles', filename='main.css') }}">
</head>
<body>
    <!-- Disclaimer Screen - Only shown if disclaimer not acknowledged -->
    <div id="screen1" {% if session.get('passed_disclaimer', False) %}class="hidden"{% endif %}>
        <h2>Disclaimer</h2>
        <p>
            The depression awareness system is not intended for medical diagnosis or to replace professional mental health services.
            Its purpose is to demonstrate the functionality of the algorithm in identifying potential early signs of depression through
            social media text analysis and to raise awareness about mental health.
            <br><br>
            This tool provides users with insights based on observed patterns in text, helping to inform and encourage reflection.
            However, it is not a substitute for a clinical assessment. If you are experiencing serious symptoms or signs of depression,
            we strongly encourage you to seek help from a licensed mental health professional.
        </p>
        <form action="{{ url_for('acknowledge_disclaimer') }}" method="POST">
            <button type="submit" class="button">I Understand</button>
        </form>
    </div>

    <!-- Detection Screen - Only shown if disclaimer acknowledged -->
    <div id="screen2" class="{% if not session.get('passed_disclaimer', False) %}hidden{% endif %} main-screen">
        <h2>Early Sign of Depression Detection</h2>
        <form id="detectionForm">
            <div class="search-box">
                <span class="icon">@</span>
                <input type="text" name="username" id="username" placeholder="Enter Twitter username..." required>
            </div>
            <button type="button" id="analyzeTweetsBtn" class="button">Fetch Tweets</button>
        </form>
        
        <div id="loadingContainer" class="loading-container hidden">
            <div class="loading-bar-container">
                <div class="loading-bar"></div>
            </div>
            <p class="loading-text">Analyzing tweets...</p>
        </div>
        
        <div id="resultContainer" class="result-container hidden">
            <p id="resultText"></p>
            
            <div id="chartContainer" class="chart-container">
                <h3>Emotion Distribution:</h3>
                
                <!-- Chart.js canvas for pie chart -->
                <canvas id="emotionChart" width="400" height="400"></canvas>
                
                <!-- Alternative CSS visualization if Chart.js fails -->
                <div id="emotionVisualization" class="emotion-visualization hidden">
                    <!-- Bars will be added dynamically via JavaScript -->
                </div>
                
                <div class="legend-container">
                    <!-- Legend items will be dynamically generated -->
                </div>
                
                <!-- Debug info for chart troubleshooting -->
                <div id="chart-debug" class="hidden"></div>
            </div>
        </div>
        
        <!-- Tweet examples modal -->
        <div id="tweetModal" class="modal hidden">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <h3 id="modalTitle">Tweets</h3>
                <div id="modalTweets" class="modal-tweets-container">
                    <!-- Tweet examples will be inserted here -->
                </div>
            </div>
        </div>
        
        <div class="organizations">
            <h3>Mental Health Resources</h3>
            <p><a href="tel:+63289214958">Philippine Mental Health Organization<br>(02) 8921 4958</a></p>
            <p><a href="tel:+639178998727">National Mental Health Center<br>tel. 1553 / cel. 0917-899-8727</a></p>
        </div>
        
        <!-- End button for main page -->
        <button id="mainEndButton" class="button end-button" onclick="location.href='/'">End</button>
    </div>
    
    <!-- Load Chart.js from CDN first -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Load the chart script -->
    <script src="{{ url_for('serve_scripts', filename='your_chart_script.js') }}"></script>
    
    <!-- Then load our custom scripts -->
    <script src="{{ url_for('serve_scripts', filename='scripts.js') }}"></script>
</body>
</html>